<!DOCTYPE html>
<html>
<head>
  <title>Мои Покупки</title>
  <link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">
  <link href="css/styles.css" rel="stylesheet"> <!-- -->
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
	<header>
		<h1>Мои Покупки</h1>
		<!-- Навигация app.html -->
		<nav class="app-nav">
			<button id="add-purchase-btn" class="btn-primary">+ Новая покупка</button>
			<button id="refresh-btn" class="btn-secondary">🔄 Обновить</button>
			<button onclick="window.location.href='stats.html'" class="btn-secondary">📈 Статистика</button>
			<button onclick="window.location.href='charts.html'" class="btn-secondary">📊 Графики</button>
			<button onclick="window.location.href='admin.html'" class="btn-secondary">⚙️ Админ-панель</button>
			<button id="logout-btn" class="btn-secondary">Выйти</button>
		</nav>
		
		<!-- Основные фильтры: -->
		<div class="filters-panel">
			<!-- Категории -->
			<div class="filter-group">
				<label>Фильтр по категориям:</label>
				<select id="category-filter">
					<option value="">Все категории</option>
				</select>
			</div>
			<!-- Даты: -->
			<div class="filter-group">
				<!-- Период "с ..." -->
				<label>Период с ...</label>
				<input type="date" id="date-from" placeholder="С">
			</div>
			<div class="filter-group">
				<!-- Период "... по" -->
				<label>Период по ...</label>
				<input type="date" id="date-to" placeholder="По">
			</div>
			<!-- Магазины -->
			<div class="filter-group">
				<label>Фильтр по магазинам:</label>
				<select id="store-filter">
					<option value="">Все магазины</option>
				</select>
			</div>
			<button id="apply-filters" class="btn-secondary">Применить</button>
			<button id="reset-filters" class="btn-secondary">Сбросить</button>
		</div>
		
		<!-- После панели фильтров -->
		<div id="active-filters-info" style="
			display: none;
			background: #e3f2fd;
			padding: 8px 12px;
			margin: 10px 0;
			border-radius: 4px;
			border-left: 4px solid #2196f3;
			font-size: 14px;
		">
			<!-- Будет заполняться динамически -->
		</div>
	</header>
	
	<main>
		<!-- После блока фильтров, перед таблицей -->
		<div class="table-info-panel" id="table-info-panel">
			<div class="info-left">
				<span id="table-status">Все данные</span>
				<div id="active-filters-info" class="active-filters"></div>
			</div>
			<div class="info-right">
				<div class="info-item">
					<span class="info-label">Покупок:</span>
					<span class="info-value" id="total-rows">0</span>
				</div>
				<div class="info-item">
					<span class="info-label">Расход:</span>
					<span class="info-value" id="total-amount">0.00 ₽</span>
				</div>
				<div class="info-item">
					<span class="info-label">Средний чек:</span>
					<span class="info-value" id="avg-amount">0.00 ₽</span>
				</div>
			</div>
		</div>
		
		<!-- Основная таблица покупок - заполняется динамически -->
		<div id="purchases-table"></div>
		<div id="loading">Загрузка данных...</div>
	</main>
  
  <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="js/api.js"></script>
  <script src="js/filters_test.js"></script>
  <script src="js/app.js"></script>
  <script src="js/stats.js"></script>
  
  <!-- Форма для добавления / редактирования покупок -->
<div id="purchase-modal" class="modal">
    <div class="modal-content compact-form">
        <span class="close-modal">&times;</span>
        <h3 id="purchase-modal-title">📝 Новая покупка</h3>
        
        <form id="purchase-form">
            <input type="hidden" id="purchase-id">
            
            <div class="form-grid">
                <!-- Первая строка -->
                <div class="form-group">
                    <label>Дата покупки</label>
                    <input type="date" id="purchase-date" required>
                </div>
				
                <div class="form-group">
                    <label>Магазин</label>
                    <select id="purchase-store" required>
                        <option value="">Выберите магазин</option>
                    </select>
                </div>
                
                <div class="form-group">
					<label>Категория</label>
					<select id="purchase-category" required>
						<option value="">Выберите категорию</option>
						<!-- Заполнится динамически -->
					</select>
				</div>
				
                <div class="form-group">
                    <label>Название товара</label>
                    <input type="text" id="purchase-name" required placeholder="Например: Молоко">
                </div>
				
				<!-- Вторая строка -->
                <div class="form-group full-width">
                    <label>Характеристики товара</label>
                    <textarea id="purchase-characteristics" placeholder="Вес, объем, особенности товара..." rows="2"></textarea>
                </div>

                <!-- Третья строка - компактная для числовых полей -->
                <div class="form-group">
                    <label>Цена за ед. (₽)</label>
                    <input type="number" id="purchase-price" step="0.01" min="0" required placeholder="0.00">
                </div>
                
                <div class="form-group">
                    <label>Количество</label>
                    <input type="number" id="purchase-quantity" step="0.001" min="0.001" value="1" required placeholder="1.000">
                </div>
                
                <div class="form-group">
                    <label>Единица измерения</label>
                    <select id="purchase-unit" required>
                        <option value="">Единицы</option>
					</select>
                </div>
                
                <div class="form-group">
                    <label>Стоимость (₽)</label>
                    <input type="number" id="purchase-amount" step="0.01" min="0" required placeholder="0.00">
                </div>

                
            </div>
            
            <div class="form-actions">
                <button type="submit" class="btn-primary">💾 Сохранить покупку</button>
                <button type="button" id="cancel-purchase" class="btn-secondary">Отмена</button>
            </div>
        </form>
    </div>
</div>
</body>
</html>
